<tal:block>
<tal:block replace="">
<!--

Creative Commons has made the contents of this file
available under a CC-GNU-GPL license:

 http://creativecommons.org/licenses/GPL/2.0/

 A copy of the full license can be found as part of this
 distribution in the file LICENSE.TXT

You may use the ccHost software in accordance with the
terms of that license. You agree that you are solely 
responsible for your use of the ccHost software and you
represent and warrant to Creative Commons that your use
of the ccHost software will comply with the CC-GNU-GPL.

$Id$

-->
</tal:block>

<metal:block define-macro="admin_menu_page">
  <div id="cc_admin_menu_page">
    <tal:block condition="admin_menu/global_items">
      <metal:block use-macro="admin.xml/_admin_menu_page_global" />
    </tal:block>
    <tal:block condition="admin_menu/local_items">
      <metal:block use-macro="admin.xml/_admin_menu_page_local"  />
    </tal:block>
  </div>
</metal:block>

<metal:block define-macro="_admin_menu_page_global">
    <h2>${admin_menu/global_title}</h2>
    <h3>${admin_menu/global_help}</h3>
    <tal:block define="link_table_items admin_menu/global_items" />
    <metal:block use-macro="${link_table}" />
</metal:block>

<metal:block define-macro="_admin_menu_page_local">
    <h2>${admin_menu/local_title}</h2>
    <h3>${admin_menu/local_help}
      <tal:block define="baseurl php:ccc();" />
      <script>
        function change_vroot()
        {
            var box = $$('vroot_changer');
            document.location = '${baseurl}' + box.options[box.options.selectedIndex].value + '/admin/site' + '${admin_menu/subtab}' ;        
        }
      </script>
      <select onchange="change_vroot();" id="vroot_changer" >
        <tal:block repeat="root admin_menu/config_roots">
          <option tal:condition="root/selected" selected="selected" value="${root/cfg}" tal:content="root/text" />
          <option tal:condition="not: root/selected" value="${root/cfg}" tal:content="root/text" />
        </tal:block>
      </select>
    </h3>
    <div tal:condition="admin_menu/delete_url" style="width:200px;float:right">
        <a class="cc_gen_button" href="${admin_menu/delete_url}"><span tal:content="php: _('Delete this virtual rool')"  /></a>
    </div>
    <div id="cc_admin_hint">${admin_menu/local_hint}</div>
    <tal:block define="link_table_items admin_menu/local_items" />
    <metal:block use-macro="${link_table}" />
</metal:block>

<metal:block define-macro="show_activity_menu">
  <table >
    <tr>
      <td><a class="cc_gen_button" href="${home-url}activity"><span tal:content="php: _('View Current')" /></a></td>
      <td><a class="cc_gen_button" href="${home-url}activity/archive"><span tal:content="php: _('View Archive')" /></a></td>
      <tal:block condition="activity_menu/full">
        <td><a class="cc_gen_button" href="${home-url}activity/export"><span tal:content="php: _('Export')" /></a></td>
        <td><a class="cc_gen_button" href="${home-url}activity/clear"><span tal:content="php: _('Export and Clear')" /></a></td>
      </tal:block>
      <td><a class="cc_gen_button" href="${home-url}activity/admin"><span tal:content="php: _('Options')" /></a></td>
      <td style="width: 300px;"><form method="get" action="${home-url}activity/archive" id="actsearch" 
           style="position:relative;left:1px;top:1px;border: 1px solid black;height: 30px;width:250px; background-color: #CCC;">
           <tal:block define="st act-searchterm | nothing" />
            <input name="user" id="user" value="${st}" 
                style="font-size:11px;font-family:Verdana;position:absolute; left: 6px; top:6px; width: 100px;"/>
            <a style="position:absolute; left: 120px; top: 4px; width:100px;" class="cc_gen_button" href="javascript: $$('actsearch').submit();"><span tal:content="php: _('Search Archives')" /></a></form></td>
    </tr>
  </table>
</metal:block>

<metal:block define-macro="show_activity_log">
<style>
.cc_log_view td
{
   white-space: nowrap; 
}

td.vlinktd {
  border-top: 1px solid white;
  border-left: 1px solid white;
  border-right: 3px solid white;
  border-bottom: 1px solid white;
  background: #99F;
  padding: 0px;
}

a.vlink {
  color: white;
  text-decoration: none;
  padding: 0px;
  margin: 0px;
}

a.vlink:hover {
  text-decoration: none;
  background: black;;
}

</style>
<table class="cc_log_view" cellspacing="0" cellpadding="0">
  <tr><th>Date</th><th colspan="2">IP</th><th colspan="2">User</th><th>Event</th><th></th><th></th></tr>
  <tr tal:repeat="e activity_log">
    <td tal:content="php: CC_datefmt('${e/activity_log_date}','m-d-y h:ia')" />
    <td class="vlinktd">
    <a href="http://www.dnsstuff.com/tools/whois.ch?ip=${e/activity_log_ip}">IP</a></td>
    <td>
    <a href="${activity-url}?ip=${e/activity_log_ip}">${e/activity_log_ip}</a></td>
    <td class="vlinktd"><a class="vlink" tal:condition="e/activity_log_user_name"
    href="${home-url}people/${e/activity_log_user_name}">view</a></td><td><a 
      tal:condition="e/activity_log_user_name"
    href="${activity-url}?user=${e/activity_log_user_name}">${e/activity_log_user_name}</a></td>
    <td><b>${e/activity_log_event}</b></td>
    <td>${e/activity_log_param_2}</td>
    <td>${e/activity_log_param_1}</td>
    <td>${e/activity_log_param_3}</td>
  </tr>
</table>
<metal:block use-macro="${prev_next_links}" />
</metal:block>

</tal:block>