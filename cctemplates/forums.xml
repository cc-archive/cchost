<tal:block>
<tal:block replace="">
<!--

Creative Commons has made the contents of this file
available under a CC-GNU-GPL license:

 http://creativecommons.org/licenses/GPL/2.0/

 A copy of the full license can be found as part of this
 distribution in the file LICENSE.TXT

You may use the ccHost software in accordance with the
terms of that license. You agree that you are solely 
responsible for your use of the ccHost software and you
represent and warrant to Creative Commons that your use
of the ccHost software will comply with the CC-GNU-GPL.

$Id$

-->
</tal:block>

<metal:block define-macro="forum_index">
  <table class="cc_forum_index">
  <tal:block repeat="group forums">
     <tr>
       <th  class="cc_forum_group_name" colspan="4">${group/forum_group_name}</th>
     </tr>
  <tr><th />
      <th class="cc_forum_col_head" tal:content="php: CC_lang('Topics')" />
      <th class="cc_forum_col_head" tal:content="php: CC_lang('Replies')" />
      <th class="cc_forum_col_head" tal:content="php: CC_lang('Latest Post')" />
  </tr>
     <tal:block repeat="forum group/forums">
     <tr>
        <td class="cc_forum_name"><a href="${forum/link}">${forum/forum_name}</a>
         <div class="cc_forum_description" >${forum/forum_description}</div> 
        </td>
        <td class="cc_topic_reply_count">${forum/num_threads}</td>
        <td class="cc_topic_reply_count">${forum/num_posts}</td>
        <td><tal:block condition="forum/latest_post">
          <a class="cc_forum_latest_reply" href="${forum/latest_post/permalink}"><span tal:content="php: CC_datefmt('${forum/latest_post/topic_date}','D, M dS h:i a'); " /></a>
          <span tal:content="php: CC_lang('by')" />: ${forum/latest_post/user_real_name}
           
        </tal:block></td>
     </tr>
     </tal:block>
  </tal:block>
  </table>
</metal:block>

<metal:block define-macro="forum_listing">
  <metal:block use-macro="forums.xml/forum_cmds" />
  <table cellspacing="0" class="cc_forum_listing">
  <tr><th tal:content="php: CC_lang('Topic')" />
      <th tal:content="php: CC_lang('Author')" />
      <th tal:content="php: CC_lang('Replies')" />
      <th tal:content="php: CC_lang('Latest Post')" />
  </tr>
  <tal:block repeat="thread threads">
    <tr>
      <td><a class="cc_topic_name" href="${thread/thread_url}"><span
               tal:content="php: CC_strchop('${thread/oldest_topic_name}',30)" /></a>
      </td>
      <td><a href="${thread/author_url}">${thread/author_real_name}</a>
      </td>
      <td class="cc_topic_reply_count">
        ${thread/num_topics}
      </td>
      <td>
        <a class="cc_forum_latest_reply" href="${thread/newest_topic_url}"><span 
            tal:content="php: CC_datefmt('${thread/forum_thread_date}','D, M dS h:i a'); " /></a>
          <span tal:content="php: CC_lang('by')" />: ${thread/newest_real_name}
      </td>
    </tr>
  </tal:block>
  </table>
  <metal:block use-macro="${prev_next_links}" />
</metal:block>

<metal:block define-macro="forum_topic">
  <metal:block use-macro="forums.xml/forum_cmds" />
  <metal:block use-macro="topics.xml/list_topics" />
  <metal:block use-macro="forums.xml/forum_cmds" />
</metal:block>

<metal:block define-macro="forum_admin">

  <table class="forumadmin">
  <tr tal:repeat="gitem fadmin/forum_groups">
    <td><i>Group:</i> <b>${gitem}</b></td>
    <td><a href="${fadmin/edit_forum_group_link}/${repeat/gitem/key}">[ ${fadmin/edit_forum_group_text} ] </a></td>
    <td><a href="${fadmin/del_forum_group_link}/${repeat/gitem/key}">[ ${fadmin/del_forum_group_text} ] </a></td>
  </tr>

  <tr tal:repeat="fitem fadmin/forums">
    <td><i>Forum:</i> ${fitem/forum_group_name}::<b>${fitem/forum_name}</b></td>
    <td><a href="${fadmin/edit_forum_link}/${fitem/forum_id}">[ ${fadmin/edit_forum_text} ] </a></td>
    <td><a href="${fadmin/del_forum_link}/${fitem/forum_id}">[ ${fadmin/del_forum_text} ] </a></td>
  </tr>
  </table>
  <hr />
  <table>
  <tr>
    <td>
      <a class="cc_gen_button" href="${fadmin/add_forum_group_link}"><span>${fadmin/add_forum_group_text}</span></a>
    </td>
    <td>
      <a tal:condition="fadmin/forum_groups" class="cc_gen_button" 
               href="${fadmin/add_forum_link}"><span>${fadmin/add_forum_text}</span></a>
    </td>
  </tr>
  </table>
</metal:block>

<metal:block define-macro="forum_cmds" >
  <table class="cc_forum_cmds" tal:condition="forum_cmds">
   <tr>
   <td tal:repeat="cmd forum_cmds"><a class="cc_gen_button" href="${cmd/url}"><span>${cmd/text}</span></a></td>
   </tr>
  </table>
</metal:block>

<metal:block define-macro="forum_user">
  <table class="cc_forum_short">
    <tal:block repeat="topic topics">
      <tr>
        <td>
           <span class="cc_topic_date" tal:content="php: CC_datefmt('${topic/topic_date}','M d, Y  h:i a  ')" />
          </td>
         <td> <a href="${topic/topic_permalink}">${topic/forum_name} :: ${topic/topic_name}</a>
         </td>
      </tr>
      <tr>
        <td />
         <td >
              <tal:block define="text php: CC_strchop('${topic/topic_text_plain}',80);" />
              <span tal:content="text" />
        </td>
      </tr>
    </tal:block>
  </table>
  <metal:block use-macro="${prev_next_links}" />
</metal:block>

<metal:block define-macro="forum_search_results">
  <table class="cc_forum_short">
    <tal:block repeat="topic topics">
      <tr>
        <td>
           <span class="cc_topic_date" tal:content="php: CC_datefmt('${topic/topic_date}','M d, Y  h:i a  ')" />
          </td>
         <td> <a href="${topic/topic_permalink}">${topic/forum_name} :: ${topic/topic_name}</a>
         </td>
      </tr>
      <tr>
        <td />
         <td >
              <span class="cc_search_result_info">${topic/topic_search_result_info}</span>
        </td>
      </tr>
    </tal:block>
  </table>
  <metal:block use-macro="${prev_next_links}" />
</metal:block>


</tal:block>