<tal:block>
<tal:block replace="">
<!--

Creative Commons has made the contents of this file
available under a CC-GNU-GPL license:

 http://creativecommons.org/licenses/GPL/2.0/

 A copy of the full license can be found as part of this
 distribution in the file LICENSE.TXT

You may use the ccHost software in accordance with the
terms of that license. You agree that you are solely 
responsible for your use of the ccHost software and you
represent and warrant to Creative Commons that your use
of the ccHost software will comply with the CC-GNU-GPL.

$Header$

-->
</tal:block>
<style>
.org_title {
    font-weight: bold;
    margin: 4px 0px 3px 10px;
}
.org_string {
    padding: 3px;
    margin: 0px 0px 3px 14px;
}
.commit_link {
    display: block;
    font-weight: bold;
    font-size: 12px;
    margin: 4px;
    background: #333;
    color: #AAF;
    padding: 3px;
    width: 20%;
    text-align: center;
    text-decoration: none;
}

.commit_link:hover {
    color: white;
    text-decoration: none;
 }

</style>
<script>
//<!--
var mode = "$mode";
var lang = "$lang";

function on_get_lstring(listbox)
{
    var hash = listbox.options[listbox.selectedIndex].value;
    do_get_string(hash);
}

function get_target_lang()
{
    var obj = new cc_obj( 'targetlang' );
    var targetlang = obj.obj.value;
    if( !targetlang )
    {
        alert("You must specify a target language");
        return;
    }
    return targetlang;
}

function do_get_string(hash)
{
   var targetlang = get_target_lang();
   if( !targetlang )
      return;

   /* some combinations of browsers and servers just don't beleive it
      when I ask them to not-cache and IE's http obj is caching, losing
      the editor's latest changes. So, we fake the url with the current
      timestamp. */
   var t = (new Date()).getTime();
   var url = "${home-url}admin/language/getstring/" + lang + "/" + mode + 
            "/" + targetlang + "/" + hash + '?t=' + t;
   cc_get_data(url, "div_editor","Getting string data...");
}

function do_edit_string(hash)
{
    var targetlang = get_target_lang();
    if( !targetlang )
        return;
    var obj = new cc_obj( 'translated' );
    var translated;
    if(obj.obj.innerText)
        translated = obj.obj.innerText;
    else if( obj.obj.value )
        translated = obj.obj.value;
    else
    {
        alert("you're browser doesn't support this feature");
        return;
    }
    translated = escape(translated);
   /* some combinations of browsers and servers just don't beleive it
      when I ask them to not-cache and IE's http obj is caching, preventing
      reverts in the same edit session. So, we fake the url with the current
      timestamp. */
    var t = (new Date()).getTime();
    var url = "${home-url}admin/language/edit/" + targetlang + "/" + mode + 
            "/" + hash + "?string=" + translated + '&t=' + t;
    cc_get_data( url, "div_editor","Saving string data..." );
}

-->
</script>

<table><tr><td style="vertical-align: top">
<select id="string_table" size="20" style="font-size:10px" onchange="on_get_lstring(this,'get_loops_button')">
  <tal:block repeat="lstr string_table">
    <option value="${repeat/lstr/key}" tal:content="php: CC_strchop('$lstr',40)" />
  </tal:block>
</select>
</td><td style="vertical-align: top">
     <div class="org_title">Target Language:</div>
     <div style="padding-left:11px"><input id="targetlang" name="targetlang" value="" /></div>
     <script>
      var targetLangObj = new cc_obj('targetlang');
     </script>
<div id="div_editor">
</div>
</td>
</tr></table>

</tal:block>